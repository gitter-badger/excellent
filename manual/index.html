<!DOCTYPE html>
<html lang="en" e-root="app">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../src"></script>
    <script src="module_sample.js"></script>
    <script src="service_sample.js"></script>
</head>
<body e-bind="appController">

<ul e-bind="WhiteColor, BlueBackground, modify, myModule.controller1">
    <li>first</li>
</ul>

</body>
</html>

<script type="application/javascript">

    app.addController('WhiteColor', function (/* self */) {
        this.onInit = function () {
            this.node.style.color = 'white';
        };
    });

    app.addController('BlueBackground', function (/* self */) {

        this.onInit = function () {
            this.node.style.backgroundColor = 'SteelBlue';
        };
    });

    app.addController('modify', function (ctrl) {

        var nItems = 0;

        ctrl.depends(['override']);

        this.onReceive = function (data) {
            nItems = data.items;
            populate();
        };

        this.onInit = function () {

        };

        function populate() {
            // TODO: Next, how to create elements with controllers!
            while (ctrl.node.firstChild) {
                ctrl.node.removeChild(ctrl.node.firstChild);
            }
            for (var i = 0; i < nItems; i++) {
                var e = document.createElement('li');
                e.innerHTML = 'item-' + i;
                e.setAttribute('e-bind', 'override');
                ctrl.node.appendChild(e);
            }
            // now need to update the controllers:
            ctrl.bindChildren();
        }
    });

    app.addController('override', function (/* self */) {
    });

    app.addController('appController', function (/* self */) {
        this.onInit = function () {
            /* here I can initialize all other controllers */
            this.findOne('[e-bind*="modify"]').controllers[2].send({items: 30});
        };
    });

</script>
